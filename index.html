<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Karshika Mithram - Kerala Agricultural Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-green: #27ae60;
            --light-green: #2ecc71;
            --dark-green: #219653;
            --secondary-yellow: #f1c40f;
            --warning-red: #e74c3c;
            --info-blue: #3498db;
            --light-bg: #f8f9fa;
            --white: #ffffff;
            --gray: #7f8c8d;
            --dark-gray: #34495e;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Noto Sans', sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--dark-gray);
            font-size: 16px;
            line-height: 1.6;
        }

        /* Welcome Screen */
        #welcomeScreen {
            min-height: 100vh;
            background: linear-gradient(rgba(39, 174, 96, 0.9), rgba(33, 150, 83, 0.9));
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            text-align: center;
            color: white;
        }

        .app-logo {
            margin-bottom: 2rem;
        }

        .app-logo i {
            font-size: 5rem;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
        }

        .app-logo h1 {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .app-logo p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .welcome-tagline {
            max-width: 800px;
            margin: 2rem auto;
            font-size: 1.2rem;
            line-height: 1.8;
        }

        .get-started-btn {
            background-color: var(--secondary-yellow);
            color: var(--dark-gray);
            border: none;
            padding: 1rem 3rem;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 2rem;
            transition: all 0.3s;
        }

        .get-started-btn:hover {
            background-color: white;
            transform: scale(1.05);
        }

        /* Login Screen */
        #loginScreen {
            min-height: 100vh;
            background: var(--light-green);
            padding: 2rem;
            display: none;
            justify-content: center;
            align-items: center;
        }

        .login-box {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            box-shadow: var(--shadow);
        }

        .user-type-selector {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin: 2rem 0;
        }

        .user-type-btn {
            padding: 1.5rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .user-type-btn.active {
            border-color: var(--primary-green);
            background-color: rgba(39, 174, 96, 0.1);
        }

        .user-type-btn i {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            color: var(--primary-green);
        }

        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .btn {
            background-color: var(--primary-green);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
        }

        /* Main App */
        #appContainer {
            display: none;
        }

        header {
            background: linear-gradient(to right, var(--dark-green), var(--primary-green));
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .badge {
            background-color: var(--secondary-yellow);
            color: var(--dark-green);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: 600;
        }

        .badge.farmer { background-color: var(--light-green); color: white; }
        .badge.business { background-color: #e67e22; color: white; }
        .badge.citizen { background-color: var(--info-blue); color: white; }
        .badge.official { background-color: #9b59b6; color: white; }

        nav {
            background: white;
            padding: 1rem 2rem;
            display: flex;
            gap: 2rem;
            overflow-x: auto;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .nav-item {
            color: var(--gray);
            text-decoration: none;
            padding: 0.5rem 0;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .nav-item.active {
            color: var(--primary-green);
            border-bottom-color: var(--primary-green);
        }

        .container {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .card h3 {
            color: var(--primary-green);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .alert {
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .alert.warning {
            background-color: rgba(231, 76, 60, 0.1);
            border-left: 5px solid var(--warning-red);
        }

        .alert.info {
            background-color: rgba(52, 152, 219, 0.1);
            border-left: 5px solid var(--info-blue);
        }

        /* Chatbot */
        .chatbot-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
        }

        .chatbot-btn {
            background: var(--info-blue);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .chatbot-window {
            position: absolute;
            bottom: 70px;
            right: 0;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: none;
            flex-direction: column;
        }

        .chatbot-header {
            background: var(--primary-green);
            color: white;
            padding: 1rem;
            border-radius: 10px 10px 0 0;
        }

        .chatbot-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
        }

        .chatbot-input {
            padding: 1rem;
            border-top: 1px solid #ddd;
            display: flex;
            gap: 0.5rem;
        }

        .message {
            padding: 0.8rem;
            border-radius: 10px;
            margin-bottom: 0.5rem;
            max-width: 80%;
        }

        .message.user {
            background: #e3f2fd;
            margin-left: auto;
        }

        .message.bot {
            background: #f1f1f1;
        }

        /* Community Posts */
        .post {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        /* Animations */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            .user-type-selector {
                grid-template-columns: 1fr;
            }
            nav {
                gap: 1rem;
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Welcome Screen -->
    <div id="welcomeScreen">
        <div class="app-logo">
            <i class="fas fa-hands-helping"></i>
            <h1>Karshika Mithram</h1>
            <p>കൃഷി മിത്രം - Kerala's Agricultural Platform</p>
        </div>
        <div class="welcome-tagline">
            Connecting Farmers, Businesses, Government Departments and Citizens of Kerala.<br>
            A unified platform for agricultural growth, market access, and disaster management.
        </div>
        <button class="get-started-btn" onclick="showLoginScreen()">
            <i class="fas fa-play-circle"></i> Get Started
        </button>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen">
        <div class="login-box">
            <h2 style="color: var(--primary-green); text-align: center; margin-bottom: 2rem;">Karshika Mithram</h2>
            
            <div class="user-type-selector">
                <div class="user-type-btn" onclick="selectUserType('farmer')">
                    <i class="fas fa-tractor"></i>
                    <div>Farmer</div>
                </div>
                <div class="user-type-btn" onclick="selectUserType('business')">
                    <i class="fas fa-briefcase"></i>
                    <div>Business</div>
                </div>
                <div class="user-type-btn" onclick="selectUserType('citizen')">
                    <i class="fas fa-user"></i>
                    <div>Citizen</div>
                </div>
                <div class="user-type-btn" onclick="selectUserType('official')">
                    <i class="fas fa-landmark"></i>
                    <div>Government Official</div>
                </div>
            </div>

            <!-- Farmer Registration Form -->
            <div id="farmerForm" class="form-section">
                <h3>Farmer Registration</h3>
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="farmerName" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label>Kisan ID / Aadhar ID</label>
                    <input type="text" id="farmerId" placeholder="Enter Kisan ID or Aadhar ID">
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" id="farmerPhone" placeholder="Enter phone number">
                </div>
                <div class="form-group">
                    <label>District</label>
                    <select id="farmerDistrict">
                        <option value="">Select District</option>
                        <option>Alappuzha</option>
                        <option>Kottayam</option>
                        <option>Idukki</option>
                        <option>Ernakulam</option>
                        <option>Thrissur</option>
                        <option>Palakkad</option>
                        <option>Wayanad</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Panchayat</label>
                    <input type="text" id="farmerPanchayat" placeholder="Enter Panchayat name">
                </div>
                <div class="form-group">
                    <label>Land Survey Number</label>
                    <input type="text" id="surveyNumber" placeholder="Enter survey number">
                </div>
                <div class="form-group">
                    <label>Land Area (acres)</label>
                    <input type="number" id="landArea" placeholder="Enter land area">
                </div>
                <div class="form-group">
                    <label>Crops Currently Farming</label>
                    <textarea id="currentCrops" placeholder="List your crops (e.g., Rice, Coconut, Banana)"></textarea>
                </div>
                <button class="btn" onclick="registerFarmer()">Register as Farmer</button>
            </div>

            <!-- Business Registration Form -->
            <div id="businessForm" class="form-section">
                <h3>Business Registration</h3>
                <div class="form-group">
                    <label>Business Name</label>
                    <input type="text" id="businessName" placeholder="Enter business name">
                </div>
                <div class="form-group">
                    <label>Business License ID</label>
                    <input type="text" id="businessLicense" placeholder="Enter license number">
                </div>
                <div class="form-group">
                    <label>Business Type</label>
                    <select id="businessType">
                        <option value="">Select Type</option>
                        <option>Fertilizer Seller</option>
                        <option>Produce Buyer</option>
                        <option>Equipment Rental</option>
                        <option>Land Leasing</option>
                        <option>Agricultural Services</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Purpose on Platform</label>
                    <select id="businessPurpose">
                        <option value="">Select Purpose</option>
                        <option>Sell Products (Fertilizers, Equipment)</option>
                        <option>Buy Agricultural Produce</option>
                        <option>Lease Land</option>
                        <option>Both Buy and Sell</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" id="businessPhone" placeholder="Enter phone number">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="businessEmail" placeholder="Enter email">
                </div>
                <button class="btn" onclick="registerBusiness()">Register as Business</button>
            </div>

            <!-- Citizen Registration Form -->
            <div id="citizenForm" class="form-section">
                <h3>Citizen Registration</h3>
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="citizenName" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="citizenEmail" placeholder="Enter email">
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" id="citizenPhone" placeholder="Enter phone number">
                </div>
                <div class="form-group">
                    <label>District</label>
                    <select id="citizenDistrict">
                        <option value="">Select District</option>
                        <option>Alappuzha</option>
                        <option>Kottayam</option>
                        <option>Idukki</option>
                        <option>Ernakulam</option>
                        <option>Thrissur</option>
                        <option>Palakkad</option>
                        <option>Wayanad</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Interest in Agriculture</label>
                    <select id="citizenInterest">
                        <option value="">Select Interest</option>
                        <option>Home Gardening</option>
                        <option>Organic Farming</option>
                        <option>Agricultural News</option>
                        <option>Market Prices</option>
                        <option>All of the above</option>
                    </select>
                </div>
                <button class="btn" onclick="registerCitizen()">Register as Citizen</button>
            </div>

            <!-- Government Official Registration Form -->
            <div id="officialForm" class="form-section">
                <h3>Government Official Registration</h3>
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="officialName" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label>Government Email / ID</label>
                    <input type="text" id="officialId" placeholder="Enter government email or ID">
                </div>
                <div class="form-group">
                    <label>Department</label>
                    <select id="officialDept">
                        <option value="">Select Department</option>
                        <option>Agriculture Department</option>
                        <option>Panchayat Office</option>
                        <option>Krishi Vigyan Kendra</option>
                        <option>Disaster Management</option>
                        <option>Horticulture Department</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Designation</label>
                    <select id="officialDesignation">
                        <option value="">Select Designation</option>
                        <option>Agricultural Officer</option>
                        <option>Department Head</option>
                        <option>Panchayat Secretary</option>
                        <option>Field Officer</option>
                        <option>Research Scientist</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Jurisdiction District</label>
                    <select id="officialDistrict">
                        <option value="">Select District</option>
                        <option>Alappuzha</option>
                        <option>Kottayam</option>
                        <option>Idukki</option>
                        <option>Ernakulam</option>
                        <option>Thrissur</option>
                        <option>Palakkad</option>
                        <option>Wayanad</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Phone Number</label>
                    <input type="tel" id="officialPhone" placeholder="Enter phone number">
                </div>
                <button class="btn" onclick="registerOfficial()">Register as Official</button>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="appContainer">
        <!-- Header -->
        <header>
            <div class="logo-container">
                <i class="fas fa-hands-helping" style="font-size: 2rem;"></i>
                <div>
                    <h2 style="margin: 0;">Karshika Mithram</h2>
                    <small style="opacity: 0.8;">Kerala Agricultural Platform</small>
                </div>
            </div>
            <div class="user-info">
                <div id="userBadge" class="badge">User</div>
                <div id="userName" style="font-weight: 600;"></div>
                <button onclick="logout()" style="background: none; border: none; color: white; cursor: pointer;">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </header>

        <!-- Navigation -->
        <nav>
            <a href="#" class="nav-item active" onclick="showSection('dashboard')">
                <i class="fas fa-home"></i> Dashboard
            </a>
            <a href="#" class="nav-item" onclick="showSection('panchayat')">
                <i class="fas fa-map-marked-alt"></i> Panchayat Mapping
            </a>
            <a href="#" class="nav-item" onclick="showSection('crop')">
                <i class="fas fa-seedling"></i> Crop Recommendations
            </a>
            <a href="#" class="nav-item" onclick="showSection('disaster')">
                <i class="fas fa-exclamation-triangle"></i> Disaster Alerts
            </a>
            <a href="#" class="nav-item" onclick="showSection('community')">
                <i class="fas fa-users"></i> Community
            </a>
            <a href="#" class="nav-item" onclick="showSection('marketplace')">
                <i class="fas fa-shopping-cart"></i> Marketplace
            </a>
            <a href="#" class="nav-item" onclick="showSection('emergency')">
                <i class="fas fa-phone-alt"></i> Emergency
            </a>
            <a href="#" class="nav-item" onclick="showSection('profile')">
                <i class="fas fa-user"></i> Profile
            </a>
        </nav>

        <!-- Main Content -->
        <div class="container">
            <!-- Dashboard Section -->
            <div id="dashboard" class="section active">
                <h2>Dashboard</h2>
                <div class="alert info">
                    <i class="fas fa-info-circle"></i>
                    <div>Welcome to Karshika Mithram! Update your profile every 6 months for accurate recommendations.</div>
                </div>
                <div class="dashboard">
                    <div class="card">
                        <h3><i class="fas fa-map-marked-alt"></i> Panchayat Mapping</h3>
                        <p>View soil data, water availability, and suitable crops for your area.</p>
                        <button class="btn" onclick="showSection('panchayat')" style="margin-top: 1rem;">View Maps</button>
                    </div>
                    <div class="card">
                        <h3><i class="fas fa-cloud-sun-rain"></i> Weather Forecast</h3>
                        <p>Today: Partly Cloudy, 28°C<br>Rainfall: 70% chance, 15mm expected</p>
                    </div>
                    <div class="card">
                        <h3><i class="fas fa-robot"></i> AI Assistant</h3>
                        <p>Get crop advice, pest control tips, and market insights.</p>
                        <button class="btn" onclick="toggleChatbot()" style="margin-top: 1rem;">Open Chatbot</button>
                    </div>
                    <div class="card">
                        <h3><i class="fas fa-bullhorn"></i> Government Alerts</h3>
                        <p>• Subsidy for organic fertilizers<br>• Rainfall warning for Thrissur</p>
                    </div>
                    <div class="card">
                        <h3><i class="fas fa-chart-line"></i> Market Prices</h3>
                        <p>Rice: ₹28/kg<br>Coconut: ₹35/kg<br>Banana: ₹22/kg</p>
                    </div>
                    <div class="card">
                        <h3><i class="fas fa-calendar-alt"></i> Update Reminder</h3>
                        <p>Profile last updated: <span id="lastUpdate">Not yet</span></p>
                        <button class="btn" onclick="showSection('profile')" style="margin-top: 1rem;">Update Now</button>
                    </div>
                </div>
            </div>

            <!-- Panchayat Mapping Section -->
            <div id="panchayat" class="section">
                <h2>Panchayat Mapping</h2>
                <div class="alert info">
                    <i class="fas fa-info-circle"></i>
                    <div>Panchayats can update agricultural data. Citizens can view crop suitability and soil information.</div>
                </div>
                <div class="form-group">
                    <label>Select Panchayat</label>
                    <select id="panchayatSelect" onchange="loadPanchayatData()">
                        <option value="kuttanad">Kuttanad Panchayat</option>
                        <option value="wayanad">Wayanad Tribal Panchayat</option>
                        <option value="palakkad">Palakkad Grama Panchayat</option>
                    </select>
                </div>
                <div class="card">
                    <h3>Agricultural Data</h3>
                    <div id="panchayatData">
                        <p><strong>Soil Type:</strong> Alluvial soil</p>
                        <p><strong>Water Availability:</strong> High</p>
                        <p><strong>Suitable Crops:</strong> Rice, Coconut, Banana</p>
                        <p><strong>Fertility Level:</strong> High</p>
                    </div>
                    <div style="margin-top: 2rem; padding: 1rem; background: #e8f5e9; border-radius: 5px;">
                        <p><i class="fas fa-map"></i> Interactive map showing crop zones and water sources</p>
                    </div>
                    <div id="officialEditSection" style="display: none; margin-top: 2rem;">
                        <h4>Update Data (Officials Only)</h4>
                        <div class="form-group">
                            <label>Soil Type</label>
                            <input type="text" id="updateSoil">
                        </div>
                        <button class="btn" onclick="updatePanchayatData()">Update</button>
                    </div>
                </div>
            </div>

            <!-- Crop Recommendations Section -->
            <div id="crop" class="section">
                <h2>Crop Recommendations</h2>
                <div class="card">
                    <h3><i class="fas fa-cloud-sun-rain"></i> Climate-Based Advice</h3>
                    <p><strong>Current Season:</strong> Monsoon</p>
                    <p><strong>Recommended:</strong> Rice, Tapioca, Banana</p>
                    <p><strong>Market Demand:</strong> High for organic vegetables</p>
                </div>
                <div class="card" style="margin-top: 2rem;">
                    <h3><i class="fas fa-robot"></i> AI Recommendation</h3>
                    <div class="form-group">
                        <label>Select Land Type</label>
                        <select id="landType">
                            <option>Wetland</option>
                            <option>Dryland</option>
                            <option>Garden Land</option>
                        </select>
                    </div>
                    <button class="btn" onclick="getCropRecommendation()">Get Recommendation</button>
                    <div id="recommendationResult" style="display: none; margin-top: 1rem; padding: 1rem; background: #f1f8e9;">
                        <p><strong>Recommended Crop:</strong> <span id="recommendedCrop">Rice</span></p>
                        <p><strong>Reason:</strong> Suitable for current monsoon conditions</p>
                    </div>
                </div>
            </div>

            <!-- Disaster Alerts Section -->
            <div id="disaster" class="section">
                <h2>Disaster Alerts</h2>
                <div class="alert warning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <div><strong>Active Alert:</strong> Heavy rainfall warning for Alappuzha and Kottayam districts</div>
                </div>
                <div class="dashboard">
                    <div class="card">
                        <h3><i class="fas fa-bell"></i> Real-time Alerts</h3>
                        <p><strong>Kuttanad Panchayat:</strong> Flood Warning Level 2</p>
                        <p><strong>Advice:</strong> Move equipment to higher ground</p>
                    </div>
                    <div class="card">
                        <h3><i class="fas fa-history"></i> Disaster History</h3>
                        <div class="form-group">
                            <label>Select Location</label>
                            <select id="disasterLocation">
                                <option>Alappuzha</option>
                                <option>Kottayam</option>
                                <option>Idukki</option>
                            </select>
                        </div>
                        <button class="btn" onclick="showDisasterHistory()">View History</button>
                        <div id="historyResult" style="display: none; margin-top: 1rem;">
                            <p>• 2018: Severe floods</p>
                            <p>• 2019: Landslides</p>
                        </div>
                    </div>
                    <div class="card">
                        <h3><i class="fas fa-shield-alt"></i> Preventive Measures</h3>
                        <p>• Construct drainage channels</p>
                        <p>• Plant flood-resistant varieties</p>
                        <p>• Keep emergency kit ready</p>
                    </div>
                </div>
            </div>

            <!-- Community Section -->
            <div id="community" class="section">
                <h2>Community Dashboard</h2>
                <div class="card" style="margin-bottom: 2rem;">
                    <h3>Create Post</h3>
                    <div class="form-group">
                        <label>Post Type</label>
                        <select id="postType">
                            <option>Question</option>
                            <option>Crop Issue</option>
                            <option>Success Story</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Message</label>
                        <textarea id="postContent" rows="3"></textarea>
                    </div>
                    <button class="btn" onclick="createPost()">Post to Community</button>
                </div>
                <h3>Recent Posts</h3>
                <div class="post">
                    <div class="post-header">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div class="badge farmer">Farmer</div>
                            <div><strong>Rajesh Kumar</strong></div>
                        </div>
                        <small>2 hours ago</small>
                    </div>
                    <p>Yellow spots on paddy leaves. Any suggestions for treatment?</p>
                </div>
                <div class="post">
                    <div class="post-header">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <div class="badge official">Agri Officer</div>
                            <div><strong>Agriculture Department</strong></div>
                        </div>
                        <small>1 day ago</small>
                    </div>
                    <p><strong>Announcement:</strong> 50% subsidy on drip irrigation systems. Apply before Nov 30.</p>
                </div>
            </div>

            <!-- Marketplace Section -->
            <div id="marketplace" class="section">
                <h2>Marketplace</h2>
                <div class="dashboard">
                    <div class="card">
                        <h3><i class="fas fa-shopping-basket"></i> Buy Products</h3>
                        <select class="form-group" style="margin-top: 1rem;">
                            <option>Fruits</option>
                            <option>Vegetables</option>
                            <option>Grains</option>
                            <option>Fertilizers</option>
                        </select>
                        <div style="margin-top: 1rem;">
                            <p><strong>Organic Rice</strong> - 100kg</p>
                            <p>Price: ₹28/kg</p>
                            <button class="btn" style="padding: 0.5rem;">Place Bid</button>
                        </div>
                    </div>
                    <div class="card">
                        <h3><i class="fas fa-store"></i> Sell Products</h3>
                        <div class="form-group" style="margin-top: 1rem;">
                            <label>Product Name</label>
                            <input type="text" placeholder="e.g., Organic Rice">
                        </div>
                        <div class="form-group">
                            <label>Quantity</label>
                            <input type="text" placeholder="e.g., 100kg">
                        </div>
                        <button class="btn">List for Sale</button>
                    </div>
                </div>
            </div>

            <!-- Emergency Section -->
            <div id="emergency" class="section">
                <h2>Emergency Services</h2>
                <div class="alert warning">
                    <i class="fas fa-exclamation-circle"></i>
                    <div>Use these contacts in case of agricultural emergency or natural disaster.</div>
                </div>
                <div class="dashboard">
                    <div class="card">
                        <h3><i class="fas fa-phone-alt"></i> Emergency Contacts</h3>
                        <p><strong>Disaster Management:</strong> 1077</p>
                        <p><strong>Agricultural Crisis:</strong> 0471-123456</p>
                        <p><strong>Police:</strong> 100</p>
                        <p><strong>Ambulance:</strong> 108</p>
                    </div>
                    <div class="card">
                        <h3><i class="fas fa-location-arrow"></i> Share Location</h3>
                        <button class="btn" onclick="shareLocation()">Share My Location</button>
                        <div id="locationStatus" style="display: none; margin-top: 1rem; padding: 1rem; background: #e8f5e9;">
                            <p>Location shared with emergency services.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profile" class="section">
                <h2>Profile Management</h2>
                <div class="card">
                    <h3>Update Your Information</h3>
                    <div id="profileContent">
                        <!-- Dynamic content based on user type -->
                    </div>
                    <button class="btn" onclick="updateProfile()">Update Profile</button>
                    <div style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #ddd;">
                        <p><strong>Last Updated:</strong> <span id="profileLastUpdate">Not yet updated</span></p>
                        <p><strong>Next Update Due:</strong> <span id="nextUpdate">Within 6 months</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chatbot -->
        <div class="chatbot-container">
            <div class="chatbot-btn" onclick="toggleChatbot()">
                <i class="fas fa-robot"></i>
            </div>
            <div id="chatbotWindow" class="chatbot-window">
                <div class="chatbot-header">
                    <h3 style="margin: 0;">Krishi AI Assistant</h3>
                </div>
                <div class="chatbot-messages" id="chatbotMessages">
                    <div class="message bot">
                        Hello! I'm your agricultural assistant. How can I help you today?
                    </div>
                </div>
                <div class="chatbot-input">
                    <input type="text" id="chatInput" placeholder="Type your question..." style="flex: 1;">
                    <button onclick="sendChatMessage()" style="padding: 0.5rem 1rem; background: var(--primary-green); color: white; border: none; border-radius: 5px;">Send</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Application State
        let currentUser = null;
        let currentUserType = null;
        let userData = {};

        // Initialize
        function init() {
            // Check if user is already logged in
            const savedUser = localStorage.getItem('krishiMithramUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                currentUserType = currentUser.type;
                showApp();
            } else {
                showWelcomeScreen();
            }
        }

        // Show welcome screen
        function showWelcomeScreen() {
            document.getElementById('welcomeScreen').style.display = 'flex';
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').style.display = 'none';
        }

        // Show login screen
        function showLoginScreen() {
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
            selectUserType('farmer');
        }

        // Select user type
        function selectUserType(type) {
            // Update button styles
            document.querySelectorAll('.user-type-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.closest('.user-type-btn').classList.add('active');

            // Show appropriate form
            document.querySelectorAll('.form-section').forEach(form => {
                form.style.display = 'none';
            });
            document.getElementById(`${type}Form`).style.display = 'block';
            
            currentUserType = type;
        }

        // Farmer Registration
        function registerFarmer() {
            const farmerData = {
                type: 'farmer',
                name: document.getElementById('farmerName').value,
                id: document.getElementById('farmerId').value,
                phone: document.getElementById('farmerPhone').value,
                district: document.getElementById('farmerDistrict').value,
                panchayat: document.getElementById('farmerPanchayat').value,
                surveyNumber: document.getElementById('surveyNumber').value,
                landArea: document.getElementById('landArea').value,
                crops: document.getElementById('currentCrops').value,
                registrationDate: new Date().toISOString().split('T')[0]
            };

            if (!farmerData.name || !farmerData.id) {
                alert('Please fill required fields');
                return;
            }

            currentUser = farmerData;
            localStorage.setItem('krishiMithramUser', JSON.stringify(farmerData));
            showApp();
        }

        // Business Registration
        function registerBusiness() {
            const businessData = {
                type: 'business',
                name: document.getElementById('businessName').value,
                license: document.getElementById('businessLicense').value,
                businessType: document.getElementById('businessType').value,
                purpose: document.getElementById('businessPurpose').value,
                phone: document.getElementById('businessPhone').value,
                email: document.getElementById('businessEmail').value,
                registrationDate: new Date().toISOString().split('T')[0]
            };

            if (!businessData.name || !businessData.license) {
                alert('Please fill required fields');
                return;
            }

            currentUser = businessData;
            localStorage.setItem('krishiMithramUser', JSON.stringify(businessData));
            showApp();
        }

        // Citizen Registration
        function registerCitizen() {
            const citizenData = {
                type: 'citizen',
                name: document.getElementById('citizenName').value,
                email: document.getElementById('citizenEmail').value,
                phone: document.getElementById('citizenPhone').value,
                district: document.getElementById('citizenDistrict').value,
                interest: document.getElementById('citizenInterest').value,
                registrationDate: new Date().toISOString().split('T')[0]
            };

            if (!citizenData.name || !citizenData.email) {
                alert('Please fill required fields');
                return;
            }

            currentUser = citizenData;
            localStorage.setItem('krishiMithramUser', JSON.stringify(citizenData));
            showApp();
        }

        // Official Registration
        function registerOfficial() {
            const officialData = {
                type: 'official',
                name: document.getElementById('officialName').value,
                id: document.getElementById('officialId').value,
                department: document.getElementById('officialDept').value,
                designation: document.getElementById('officialDesignation').value,
                district: document.getElementById('officialDistrict').value,
                phone: document.getElementById('officialPhone').value,
                registrationDate: new Date().toISOString().split('T')[0]
            };

            if (!officialData.name || !officialData.id) {
                alert('Please fill required fields');
                return;
            }

            currentUser = officialData;
            localStorage.setItem('krishiMithramUser', JSON.stringify(officialData));
            showApp();
        }

        // Show main app
        function showApp() {
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';

            // Update UI
            document.getElementById('userName').textContent = currentUser.name;
            document.getElementById('userBadge').textContent = currentUser.type.charAt(0).toUpperCase() + currentUser.type.slice(1);
            document.getElementById('userBadge').className = `badge ${currentUser.type}`;

            // Show official features if applicable
            if (currentUser.type === 'official') {
                document.getElementById('officialEditSection').style.display = 'block';
            }

            // Set last update date
            const lastUpdate = new Date();
            lastUpdate.setMonth(lastUpdate.getMonth() - 1);
            document.getElementById('lastUpdate').textContent = lastUpdate.toISOString().split('T')[0];
            document.getElementById('profileLastUpdate').textContent = lastUpdate.toISOString().split('T')[0];

            // Calculate next update
            const nextUpdate = new Date(lastUpdate);
            nextUpdate.setMonth(nextUpdate.getMonth() + 6);
            document.getElementById('nextUpdate').textContent = nextUpdate.toISOString().split('T')[0];

            // Load profile data
            loadProfileData();
        }

        // Show section
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });

            // Remove active class from nav
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionId).style.display = 'block';

            // Add active class to nav
            event.target.closest('.nav-item').classList.add('active');
        }

        // Load panchayat data
        function loadPanchayatData() {
            const panchayat = document.getElementById('panchayatSelect').value;
            let data = {};
            
            switch(panchayat) {
                case 'kuttanad':
                    data = { soil: "Alluvial", water: "High", crops: "Rice, Coconut", fertility: "High" };
                    break;
                case 'wayanad':
                    data = { soil: "Laterite", water: "Medium", crops: "Coffee, Pepper", fertility: "Medium" };
                    break;
                case 'palakkad':
                    data = { soil: "Black", water: "Low", crops: "Sugarcane, Mango", fertility: "Medium" };
                    break;
            }

            document.getElementById('panchayatData').innerHTML = `
                <p><strong>Soil Type:</strong> ${data.soil}</p>
                <p><strong>Water Availability:</strong> ${data.water}</p>
                <p><strong>Suitable Crops:</strong> ${data.crops}</p>
                <p><strong>Fertility Level:</strong> ${data.fertility}</p>
            `;
        }

        // Get crop recommendation
        function getCropRecommendation() {
            const landType = document.getElementById('landType').value;
            let crop = "Rice";
            if (landType === "Dryland") crop = "Millets";
            if (landType === "Garden Land") crop = "Vegetables";
            
            document.getElementById('recommendedCrop').textContent = crop;
            document.getElementById('recommendationResult').style.display = 'block';
        }

        // Show disaster history
        function showDisasterHistory() {
            document.getElementById('historyResult').style.display = 'block';
        }

        // Create post
        function createPost() {
            const content = document.getElementById('postContent').value;
            if (content) {
                alert('Post created successfully!');
                document.getElementById('postContent').value = '';
            }
        }

        // Share location
        function shareLocation() {
            document.getElementById('locationStatus').style.display = 'block';
            setTimeout(() => {
                alert('Location shared with emergency services');
            }, 500);
        }

        // Load profile data
        function loadProfileData() {
            let html = '';
            
            if (currentUser.type === 'farmer') {
                html = `
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" value="${currentUser.name}">
                    </div>
                    <div class="form-group">
                        <label>Phone Number</label>
                        <input type="tel" value="${currentUser.phone}">
                    </div>
                    <div class="form-group">
                        <label>District</label>
                        <input type="text" value="${currentUser.district}">
                    </div>
                    <div class="form-group">
                        <label>Land Area (acres)</label>
                        <input type="number" value="${currentUser.landArea}">
                    </div>
                `;
            } else if (currentUser.type === 'business') {
                html = `
                    <div class="form-group">
                        <label>Business Name</label>
                        <input type="text" value="${currentUser.name}">
                    </div>
                    <div class="form-group">
                        <label>License Number</label>
                        <input type="text" value="${currentUser.license}">
                    </div>
                    <div class="form-group">
                        <label>Business Type</label>
                        <input type="text" value="${currentUser.businessType}">
                    </div>
                `;
            } else if (currentUser.type === 'official') {
                html = `
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" value="${currentUser.name}">
                    </div>
                    <div class="form-group">
                        <label>Designation</label>
                        <input type="text" value="${currentUser.designation}">
                    </div>
                    <div class="form-group">
                        <label>Department</label>
                        <input type="text" value="${currentUser.department}">
                    </div>
                `;
            } else {
                html = `
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" value="${currentUser.name}">
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" value="${currentUser.email}">
                    </div>
                `;
            }

            document.getElementById('profileContent').innerHTML = html;
        }

        // Update profile
        function updateProfile() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('profileLastUpdate').textContent = today;
            document.getElementById('lastUpdate').textContent = today;
            
            const nextUpdate = new Date();
            nextUpdate.setMonth(nextUpdate.getMonth() + 6);
            document.getElementById('nextUpdate').textContent = nextUpdate.toISOString().split('T')[0];
            
            alert('Profile updated successfully!');
        }

        // Update panchayat data
        function updatePanchayatData() {
            alert('Panchayat data updated!');
        }

        // Chatbot functions
        function toggleChatbot() {
            const chatbot = document.getElementById('chatbotWindow');
            chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
        }

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message
            const messagesDiv = document.getElementById('chatbotMessages');
            const userMsg = document.createElement('div');
            userMsg.className = 'message user';
            userMsg.textContent = message;
            messagesDiv.appendChild(userMsg);
            
            // Clear input
            input.value = '';
            
            // Get AI response
            setTimeout(() => {
                const responses = [
                    "For paddy cultivation, ensure proper water drainage during heavy rains.",
                    "Use organic fertilizers for better soil health.",
                    "Check market prices before selling your produce.",
                    "Contact your agricultural officer for subsidy information.",
                    "Plant flood-resistant varieties in low-lying areas."
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                
                const botMsg = document.createElement('div');
                botMsg.className = 'message bot';
                botMsg.textContent = randomResponse;
                messagesDiv.appendChild(botMsg);
                
                // Scroll to bottom
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }, 1000);
        }

        // Logout
        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('krishiMithramUser');
                showWelcomeScreen();
            }
        }

        // Initialize on load
        window.onload = init;
    </script>
</body>
</html>
